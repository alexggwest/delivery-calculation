# Delivery-calculation
web-сервис для расчета стоимости доставки

###### Запуск приложения:
1. Выполнить `docker-compose up -d`.
2. Установить composer пакеты: `composer install`

###### Функциональность сервиса:
- Прием запроса
- Проверка полученных данные
- Рассчет стоимость опций предполагаемой доставки
- Расчет итоговой суммы доставки (сумма посылки + сумма опций)
- Формирование ответа

Сниппет запроса:
{ “description”: “Important gift”, “parcel_type”: “box”, “options”: { “size”: “medium”, “delivery_type”: “international”, “receive_type”: “ordered” } }

Сниппет ответа:
{ “value”: 48.50 }

## Настройка стоимости через переменные окружения:

.env

###SET DELIVERY PRICE

###### Добавление новой переменной окружения со значением стоимости

1. Добавить переменную в файл .env
2. Добавить переменную в `parameters:` файла `services.yaml`
3. Загрузка значений стоимости из переменных окружения происходит с помощью метода `load_parcel_price()` сервиса `LoadDeliveryPrice`.
   Сервис ожидает значений `parameters:` из `services.yaml` в формате:
- для типа посылки `app.price.parcel.{значение типа посылки}`
- для значения опции посылки `app.price.{значение опции}.{значение типа опции}`
- для уникальной стоимости опции для определенноги типа посылки `app.price.{значение опции}.{значение типа опции}.{тип посылки}`

###### Добавление нового типа посылки
1. Для обеспечения  валидации:
- создать новую константу со значением типа посылки в константах класса `App\Delivery\Domain\Entity\Parcel`
- добавить созданную константу в массив констант  `const PARCEL_TYPE[]` класса
3. Добавить переменную окружения со значением стоимости (см. `"Добавление новой переменной окружения со значением стоимости"`)

###### Добавление новой опции
1. Добавить новое свойство в класс `App\Delivery\Domain\Entity\Options`
2. Добавить значения для новой опции Cм. `"Добавление нового значения опции"`
3. Дополнительно для обеспечения валидации необходимо:
- добавить созданный в п. 2 массив констант в массив констант `const OPTIONS[]`, ключ=значение опции (например `payment`)
- Добавить новое поле в форму (класс `App\Delivery\Infrastructure\Form\OtionsType`)
  и передать ключ из массива в валидатор `'constraints' => new IsOptionExist(['option' => 'payment'])]`
  4.Добавить загрузку стоимости значений опции из переменных окружения в метод `load_parcel_price()` сервиса `LoadDeliveryPrice`

###### Добавление нового значения опции
1. Для обеспечения  валидации:
- создать новую константу со значением опции в константах класса `App\Delivery\Domain\Entity\Options`
- добавить созданную константу в массив констант соответствующей опции класса
2. Добавить переменную окружения со стоимостью нового значения опции (см. `"Добавление новой переменной окружения со значением стоимости"`)



